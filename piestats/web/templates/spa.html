<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SPA</title>
  <link rel="stylesheet" href="{{url_for('static', filename='slate.css')}}">
  <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.6/handlebars.min.js"></script>
  <script src="{{url_for('static', filename='navigo.min.js')}}"></script>
  <script src="{{url_for('static', filename='pystats_spa.js')}}"></script>
</head>
<body>

<div class="container" style="margin-top: 100px; margin-bottom: 100px;">
  <div class="page-header" style="border: none;">
    <h1></h1>
    <ul id="tab-bar" class="nav nav-tabs">
      <li><a href="/" role="presentation" data-navigo>Overview</a></li>
      <li><a href="players" role="presentation" data-navigo>Top Players</a></li>
      <li><a href="weapons" role="presentation" data-navigo>Top Weapons</a></li>
      <li><a href="kills" role="presentation" data-navigo>Latest Kills</a></li>
    </ul>
  </div>
  <div id="body"></div>
  <footer>
    Generated by <a href="https://github.com/jrgp/soldat-pystats">Soldat Pystats</a> by Joe Gillotti.
  </footer>
</div>

{% raw %}
<script id="top_server_selector" type="text/x-handlebars-template">
<nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="" data-navigo>{{title}}</a>
    </div>
    <div class="collapse navbar-collapse" id="top_nav_collapse">
      <p class="navbar-text pull-right">
        {{ num_kills }} kills by {{ num_players }} players since {{ since_when }}
      </p>
{% if servers|length > 1 %}
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">More Servers<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            {% for server in servers %}
              <li><a href="{{

                url_for(
                  request.url_rule.endpoint if request.url_rule.endpoint in [] else 'index',
                  server_slug=server.url_slug
                  )

                }}">{{server.title}}</a></li>
            {% endfor %}
          </ul>
        </li>
      </ul>
{% endif %}
      <form class="navbar-form navbar-left" role="search" method="get" action="{{ slug }}/search" id="search_form"
        onsubmit="return $($(this).find('input[name=player]')[0]).val().trim() != '';">
        <div class="form-group">
          <input class="form-control input-sm" placeholder="Player search" type="text" name="player" value="">
        </div>
        <input type="submit" class="btn btn-default" value="Search!">
      </form>
    </div>
  </div>
</nav>
</script>

<script id="kills_template" type="text/x-handlebars-template">
<nav>
  <ul class="pager">
  {{#notFalse prev_pos}}
    <li><a href="kills/pos/{{ prev_pos }}" data-navigo>Previous</a></li>
  {{else}}
    <li class="disabled"><a href="" onclick="return false;"><span aria-hidden="true">Previous</span></a></li>
  {{/notFalse}}
  {{#notFalse next_pos }}
    <li><a href="kills/pos/{{ next_pos }}" data-navigo>Next</a></li>
  {{else}}
    <li class="disabled"><a href="" onclick="return false;"><span aria-hidden="true">Next</span></a></li>
  {{/notFalse}}
  </ul>
</nav>
<div class="panel panel-default">
  <table class="table table-striped">
    <thead>
      <tr>
        <th colspan="2">Killer</th>
        <th colspan="2">Victim</th>
        <th colspan="2">Weapon</th>
        <th>When</th>
      </tr>
    </thead>
    <tbody>
    {{#each kills}}
      <tr>
        <td style="width: 0;">
          {{#playerShowCountry killer}}
            <img width="16" height="11" src="/static/flags/{{lowerStr killer_country}}.png">
          {{/playerShowCountry}}
        </td>
        <td style=""><a href="player/{{killer}}" data-navigo>{{ killer }}</a></td>
        <td style="width: 0;">
          {{#playerShowCountry victim}}
            <img width="16" height="11" src="/static/flags/{{lowerStr victim_country}}.png">
          {{/playerShowCountry}}
        </td>
        <td style=""><a href="player/{{victim}}" data-navigo>{{ victim }}</a></td>
        <td style="width: 0; text-align: right;"><img src="/static/soldatguns/{{weaponFilename weapon}}" title="{{weapon}}"></td>
        <td>{{ weapon }}</td>
        <td>{{ date }}</td>
      </tr>
    {{/each}}
    </tbody>
  </table>
</div>
</script>

<script id="weapons_template" type="text/x-handlebars-template">
<div class="panel panel-default">
  <table class="table table-striped">
    <thead>
      <tr>
        <th colspan="2">Weapon</th>
        <th>Kills</th>
      </tr>
    </thead>
    <tbody>
      {{#each weapons}}
      <tr>
        <td width="10" style="text-align: right;">
          <img src="/static/soldatguns/{{weaponFilename this}}" title="{{0}}">
        </td>
        <td>{{0}}</td>
        <td>{{1}}</td>
      </tr>
      {{/each}}
    </tbody>
  </table>
</div>
</script>

<script id="players_template" type="text/x-handlebars-template">
<nav>
  <ul class="pager">
  {{#notFalse prev_pos}}
    <li><a href="players/pos/{{ prev_pos }}" data-navigo>Previous</a></li>
  {{else}}
    <li class="disabled"><a href="" onclick="return false;"><span aria-hidden="true">Previous</span></a></li>
  {{/notFalse}}
  {{#notFalse next_pos }}
    <li><a href="players/pos/{{ next_pos }}" data-navigo>Next</a></li>
  {{else}}
    <li class="disabled"><a href="" onclick="return false;"><span aria-hidden="true">Next</span></a></li>
  {{/notFalse}}
  </ul>
</nav>
<div class="panel panel-default">
  <table class="table table-striped">
    <thead>
      <tr>
        <th colspan="2">Player</th>
        <th>Kills</th>
        <th>Deaths</th>
        <th>Firstseen</th>
        <th>Lastseen</th>
      </tr>
    </thead>
    <tbody>
      {{#each players}}
      <tr>
        <td style="width: 0;">
          {{#playerShowCountry this}}
            <img width="16" height="11" src="/static/flags/{{lowerStr lastcountry}}.png">
          {{/playerShowCountry}}
        </td>
        <td style="width: 0;"><a href="player/{{name}}" data-navigo>{{name}}</a></td>
        <td>{{kills}}</td>
        <td>{{deaths}}</td>
        <td>{{firstseen}}</td>
        <td>{{lastseen}}</td>
      </tr>
      {{/each}}
    </tbody>
  </table>
</div>
</script>

<script id="players_profile_template" type="text/x-handlebars-template">
<div class="row">
  <div class="col-xs-12  col-md-6">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Overview</h3>
      </div>
      <table class="table table-striped">
        <tbody>
          <!-- Offset stripe highlight by one -->
          <tr></tr>
          <tr>
            <th>Name</th>
            <td>{{ player.info.name }}</td>
          </tr>
          <tr>
            <th>Kills</th>
            <td>{{ player.info.kills }}</td>
          </tr>
          <tr>
            <th>Deaths</th>
            <td>{{ player.info.deaths }}</td>
          </tr>
          <tr>
            <th>Last Seen</th>
            <td>{{ player.info.lastseen }}</td>
          </tr>
          <tr>
            <th>First Seen</th>
            <td>{{ player.info.firstseen }}</td>
          </tr>
          {{#playerShowCountry player.info}}
          <tr>
            <th>Country</th>
            <td>
              <img width="16" height="11" src="/static/flags/{{lowerStr player.info.lastcountry}}.png">
            </td>
          </tr>
          {{/playerShowCountry}}
        </tbody>
      </table>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Weapons</h3>
      </div>
      <table class="table table-striped">
        <thead>
          <tr>
            <th colspan="2" style="text-align: left;">Wep</th>
            <th>Kills</th>
            <th>Deaths</th>
          </tr>
         </thead>
         <tbody>
          {{#each player.wepstats}}
            <tr>
              <td width="10" style="text-align: right;">
                <img src="/static/soldatguns/{{weaponFilename name}}" title="{{name}}">
              </td>
              <td>{{ name }}</td>
              <td>{{ defaultZero kills }}</td>
              <td>{{ defaultZero deaths }}</td>
            </tr>
          {{/each}}
         </tbody>
      </table>
    </div>
  </div>
  <div class="col-xs-12  col-md-6">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Top Victims</h3>
      </div>
      <table class="table table-striped">
        <thead>
          <tr>
            <th colspan="2">Player</th>
            <th>Kills</th>
          </tr>
         </thead>
         <tbody>
          {{#each top_victims}}
            <tr>
              <td style="text-align: right; width: 0;">
                {{#playerShowCountry info.name}}
                  <img width="16" height="11" src="/static/flags/{{lowerStr info.lastcountry}}.png">
                {{/playerShowCountry}}
              </td>
              <td><a href="player/{{info.name}}" data-navigo>{{info.name}}</a></td>
              <td style="width: 50%;">{{ info.kills }}</td>
            </tr>
          {{/each}}
         </tbody>
      </table>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Top Enemies</h3>
      </div>
      <table class="table table-striped">
        <thead>
          <tr>
            <th colspan="2">Player</th>
            <th>Deaths</th>
          </tr>
         </thead>
         <tbody>
          {{#each top_enemies}}
            <tr>
              <td style="text-align: right; width: 0;">
                {{#playerShowCountry info.name}}
                  <img width="16" height="11" src="/static/flags/{{lowerStr info.lastcountry}}.png">
                {{/playerShowCountry}}
              </td>
              <td><a href="player/{{info.name}}" data-navigo>{{info.name}}</a></td>
              <td style="width: 50%;">{{ info.kills }}</td>
            </tr>
          {{/each}}
         </tbody>
      </table>
    </div>
  </div>
</div>
</script>

{% endraw %}

<script>
  $(pystats_app);
</script>

</body>
</html>
